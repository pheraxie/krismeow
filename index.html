<!doctype html>
<html lang="fr" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Krismeow</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
      font-family: 'Quicksand', sans-serif;
    }
    
    * {
      box-sizing: border-box;
    }

    .starry-sky {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: 0;
      transition: all 1s ease;
    }

    .starry-sky.day {
      background: linear-gradient(180deg, 
        #87CEEB 0%, 
        #98D8E8 25%,
        #B0E0E6 50%, 
        #FFB6C1 75%,
        #FFA07A 100%
      );
    }

    .starry-sky.night {
      background: linear-gradient(180deg, 
        #0a0e27 0%, 
        #1a1547 25%,
        #2d1b69 50%, 
        #4a2b7a 75%,
        #6b3d8f 100%
      );
    }

    .star {
      position: absolute;
      background: white;
      border-radius: 50%;
      animation: twinkle 3s ease-in-out infinite;
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
    }

    @keyframes twinkle {
      0%, 100% {
        opacity: 0.3;
        transform: scale(1);
      }
      50% {
        opacity: 1;
        transform: scale(1.2);
      }
    }

    .shooting-star {
      position: absolute;
      width: 2px;
      height: 2px;
      background: white;
      border-radius: 50%;
      box-shadow: 0 0 10px 2px rgba(255, 255, 255, 0.8);
      animation: shoot 2s linear;
    }

    @keyframes shoot {
      0% {
        transform: translateX(0) translateY(0);
        opacity: 1;
      }
      100% {
        transform: translateX(300px) translateY(300px);
        opacity: 0;
      }
    }

    .ai-bubble {
      position: fixed;
      width: 100px;
      height: 100px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 50%;
      box-shadow: 0 10px 40px rgba(102, 126, 234, 0.6);
      cursor: pointer;
      z-index: 1000;
      transition: transform 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      user-select: none;
      animation: float 6s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% {
        transform: translateY(0px) translateX(0px);
      }
      25% {
        transform: translateY(-30px) translateX(20px);
      }
      50% {
        transform: translateY(-10px) translateX(-20px);
      }
      75% {
        transform: translateY(-40px) translateX(10px);
      }
    }

    .ai-bubble:hover {
      animation-play-state: paused;
      transform: scale(1.1);
    }

    .ai-eyes {
      display: flex;
      gap: 15px;
      margin-bottom: 8px;
    }

    .ai-eye {
      width: 18px;
      height: 18px;
      background: white;
      border-radius: 50%;
      position: relative;
      animation: blink 4s infinite;
    }

    .ai-pupil {
      width: 8px;
      height: 8px;
      background: #1a1a3e;
      border-radius: 50%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      animation: look-around 5s infinite;
    }

    @keyframes blink {
      0%, 98%, 100% {
        transform: scaleY(1);
      }
      99% {
        transform: scaleY(0.1);
      }
    }

    @keyframes look-around {
      0%, 100% {
        transform: translate(-50%, -50%);
      }
      25% {
        transform: translate(-30%, -50%);
      }
      50% {
        transform: translate(-50%, -30%);
      }
      75% {
        transform: translate(-70%, -50%);
      }
    }

    .ai-mouth {
      width: 30px;
      height: 15px;
      border: 3px solid white;
      border-top: none;
      border-radius: 0 0 30px 30px;
      animation: talk 3s infinite;
    }

    @keyframes talk {
      0%, 100% {
        height: 15px;
      }
      50% {
        height: 8px;
      }
    }

    .ai-chat {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 320px;
      max-width: calc(100vw - 40px);
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      padding: 20px;
      z-index: 999;
      display: none;
    }

    .ai-chat.active {
      display: block;
      animation: slideUp 0.3s ease;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .nav-link {
      position: relative;
      transition: all 0.3s ease;
    }

    .nav-link::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 0;
      height: 2px;
      background: currentColor;
      transition: width 0.3s ease;
    }

    .nav-link:hover::after,
    .nav-link.active::after {
      width: 100%;
    }

    .video-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 24px;
    }

    .video-card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      overflow: hidden;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .video-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .video-thumbnail {
      width: 100%;
      aspect-ratio: 16/9;
      object-fit: cover;
    }

    .video-info {
      padding: 16px;
    }

    .toggle-switch {
      position: relative;
      width: 60px;
      height: 30px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 15px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .toggle-switch.active {
      background: #667eea;
    }

    .toggle-slider {
      position: absolute;
      top: 3px;
      left: 3px;
      width: 24px;
      height: 24px;
      background: white;
      border-radius: 50%;
      transition: transform 0.3s;
    }

    .toggle-switch.active .toggle-slider {
      transform: translateX(30px);
    }

    .settings-card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 20px;
    }

    @media (max-width: 768px) {
      .ai-bubble {
        width: 70px;
        height: 70px;
      }

      .ai-eye {
        width: 14px;
        height: 14px;
      }

      .ai-pupil {
        width: 6px;
        height: 6px;
      }

      .ai-mouth {
        width: 24px;
        height: 12px;
      }

      .video-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full overflow-hidden"><!-- Animated Starry Sky Background -->
  <div class="starry-sky night" id="starrySky"></div><!-- Main Content Container -->
  <div class="relative z-10 h-full flex flex-col"><!-- Navigation -->
   <nav class="bg-gradient-to-r from-purple-900/30 to-indigo-900/30 backdrop-blur-md border-b border-white/10" id="navbar">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
     <div class="flex items-center justify-between h-16">
      <div class="flex items-center"><span class="text-white text-2xl font-bold" id="siteName">Krismeow</span>
      </div>
      <div class="flex space-x-1 sm:space-x-4"><button class="nav-link active px-3 py-2 text-white text-sm sm:text-base font-medium" data-page="home" data-fr="Accueil" data-en="Home">Accueil</button> <button class="nav-link px-3 py-2 text-white text-sm sm:text-base font-medium" data-page="youtube" data-fr="Contenu" data-en="Content">Contenu</button> <button class="nav-link px-3 py-2 text-white text-sm sm:text-base font-medium" data-page="settings" data-fr="Param√®tres" data-en="Settings">Param√®tres</button> <button class="nav-link px-3 py-2 text-white text-sm sm:text-base font-medium" data-page="other" data-fr="Autres" data-en="Other">Autres</button>
      </div>
     </div>
    </div>
   </nav><!-- Page Content -->
   <main class="flex-1 overflow-auto"><!-- Home Page -->
    <div id="homePage" class="page-content h-full flex flex-col items-center justify-center px-4 text-center">
     <h1 class="text-5xl sm:text-7xl font-bold text-white mb-6 animate-pulse" id="homeTitle">Bienvenue sur Krismeow</h1>
     <div class="bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-8 max-w-2xl">
      <p class="text-xl sm:text-2xl text-white mb-4" id="constructionMsg">üöß This site is still under construction üöß</p>
      <p class="text-white/80 text-base sm:text-lg" id="aiIntro">Notre IA <span class="font-bold" id="aiNameDisplay">Pheraxie</span> vous accompagne dans cette aventure !</p>
     </div>
    </div><!-- YouTube/Content Page -->
    <div id="youtubePage" class="page-content hidden h-full">
     <div class="max-w-7xl mx-auto px-4 py-8">
      <h2 class="text-4xl font-bold text-white mb-8 text-center" id="youtubePageTitle">Contenu</h2>
      <div id="videoGrid" class="video-grid">
       <div class="text-white text-center text-xl" id="loadingVideos">
        Chargement des vid√©os...
       </div>
      </div>
     </div>
    </div><!-- Settings Page -->
    <div id="settingsPage" class="page-content hidden h-full overflow-auto">
     <div class="max-w-4xl mx-auto px-4 py-8">
      <h2 class="text-4xl font-bold text-white mb-8" id="settingsTitle">Param√®tres</h2><!-- Theme Setting -->
      <div class="settings-card">
       <div class="flex items-center justify-between">
        <div>
         <h3 class="text-white text-xl font-semibold mb-2" id="themeLabel">Th√®me</h3>
         <p class="text-white/70" id="themeDesc">Basculer entre le mode jour et nuit</p>
        </div>
        <div class="flex items-center gap-4"><span class="text-white" id="dayLabel">‚òÄÔ∏è Jour</span>
         <div class="toggle-switch" id="themeToggle">
          <div class="toggle-slider"></div>
         </div><span class="text-white" id="nightLabel">üåô Nuit</span>
        </div>
       </div>
      </div><!-- Language Setting -->
      <div class="settings-card">
       <div class="flex items-center justify-between">
        <div>
         <h3 class="text-white text-xl font-semibold mb-2" id="languageLabel">Langue</h3>
         <p class="text-white/70" id="languageDesc">Choisir la langue de l'interface</p>
        </div>
        <div class="flex items-center gap-4"><span class="text-white">üá´üá∑ FR</span>
         <div class="toggle-switch" id="languageToggle">
          <div class="toggle-slider"></div>
         </div><span class="text-white">üá¨üáß EN</span>
        </div>
       </div>
      </div>
     </div>
    </div><!-- Other Pages Placeholder -->
    <div id="otherPage" class="page-content hidden h-full flex items-center justify-center">
     <div class="text-white text-9xl opacity-30">
      +
     </div>
    </div>
   </main>
  </div><!-- AI Bubble (Pheraxie) -->
  <div class="ai-bubble" id="aiBubble">
   <div class="ai-eyes">
    <div class="ai-eye">
     <div class="ai-pupil"></div>
    </div>
    <div class="ai-eye">
     <div class="ai-pupil"></div>
    </div>
   </div>
   <div class="ai-mouth"></div>
  </div><!-- AI Chat Box -->
  <div class="ai-chat" id="aiChat">
   <div class="flex items-center justify-between mb-4">
    <h3 class="text-xl font-bold text-purple-900" id="aiChatName">Pheraxie</h3><button id="closeChatBtn" class="text-gray-500 hover:text-gray-700 text-2xl leading-none">√ó</button>
   </div>
   <div class="bg-gradient-to-r from-purple-100 to-indigo-100 p-4 rounded-lg">
    <p class="text-gray-800" id="aiMessage">This site is still under construction</p>
   </div>
  </div>
  <script>
    const defaultConfig = {
      site_name: 'Krismeow',
      ai_name: 'Pheraxie',
      youtube_api_key: 'AIzaSyCxK7EkKo1QpxHuUmE1tTDNPirreFoYbPc',
      youtube_channel_id: 'UCD5a6vntQBSRqZWbPjNo1ig',
      background_color: '#0a0e27',
      ai_bubble_color: '#667eea',
      text_color: '#ffffff',
      accent_color: '#764ba2',
      nav_background: '#1a1a3e'
    };

    let currentTheme = 'night';
    let currentLanguage = 'fr';
    let aiBubbleX = window.innerWidth - 150;
    let aiBubbleY = window.innerHeight / 2;

    const translations = {
      fr: {
        home: 'Accueil',
        content: 'Contenu',
        settings: 'Param√®tres',
        other: 'Autres',
        welcomeTo: 'Bienvenue sur',
        construction: 'üöß Ce site est encore en construction üöß',
        aiIntro: 'Notre IA',
        accompanies: 'vous accompagne dans cette aventure !',
        contentTitle: 'Contenu',
        loadingVideos: 'Chargement des vid√©os...',
        settingsTitle: 'Param√®tres',
        themeLabel: 'Th√®me',
        themeDesc: 'Basculer entre le mode jour et nuit',
        languageLabel: 'Langue',
        languageDesc: "Choisir la langue de l'interface",
        aiMsg: 'Ce site est encore en construction'
      },
      en: {
        home: 'Home',
        content: 'Content',
        settings: 'Settings',
        other: 'Other',
        welcomeTo: 'Welcome to',
        construction: 'üöß This site is still under construction üöß',
        aiIntro: 'Our AI',
        accompanies: 'accompanies you on this adventure!',
        contentTitle: 'Content',
        loadingVideos: 'Loading videos...',
        settingsTitle: 'Settings',
        themeLabel: 'Theme',
        themeDesc: 'Switch between day and night mode',
        languageLabel: 'Language',
        languageDesc: 'Choose the interface language',
        aiMsg: 'This site is still under construction'
      }
    };

    // Create starry sky
    function createStars() {
      const sky = document.getElementById('starrySky');
      const starCount = 200;

      for (let i = 0; i < starCount; i++) {
        const star = document.createElement('div');
        star.className = 'star';
        
        const size = Math.random() * 3 + 1;
        const left = Math.random() * 100;
        const top = Math.random() * 100;
        const delay = Math.random() * 3;

        star.style.width = `${size}px`;
        star.style.height = `${size}px`;
        star.style.left = `${left}%`;
        star.style.top = `${top}%`;
        star.style.animationDelay = `${delay}s`;

        sky.appendChild(star);
      }

      // Create shooting stars periodically
      setInterval(() => {
        const shootingStar = document.createElement('div');
        shootingStar.className = 'shooting-star';
        shootingStar.style.left = `${Math.random() * 50}%`;
        shootingStar.style.top = `${Math.random() * 50}%`;
        sky.appendChild(shootingStar);

        setTimeout(() => shootingStar.remove(), 2000);
      }, 3000);
    }

    // AI Bubble floating movement
    function moveAIBubble() {
      const bubble = document.getElementById('aiBubble');
      const maxX = window.innerWidth - 120;
      const maxY = window.innerHeight - 120;

      setInterval(() => {
        aiBubbleX += (Math.random() - 0.5) * 3;
        aiBubbleY += (Math.random() - 0.5) * 3;

        aiBubbleX = Math.max(20, Math.min(maxX, aiBubbleX));
        aiBubbleY = Math.max(20, Math.min(maxY, aiBubbleY));

        bubble.style.left = `${aiBubbleX}px`;
        bubble.style.top = `${aiBubbleY}px`;
      }, 50);
    }

    // AI Chat toggle
    document.getElementById('aiBubble').addEventListener('click', () => {
      document.getElementById('aiChat').classList.toggle('active');
    });

    document.getElementById('closeChatBtn').addEventListener('click', () => {
      document.getElementById('aiChat').classList.remove('active');
    });

    // Navigation
    const navLinks = document.querySelectorAll('.nav-link');
    const pages = document.querySelectorAll('.page-content');

    navLinks.forEach(link => {
      link.addEventListener('click', () => {
        const targetPage = link.getAttribute('data-page');
        
        navLinks.forEach(l => l.classList.remove('active'));
        link.classList.add('active');

        pages.forEach(page => page.classList.add('hidden'));
        document.getElementById(`${targetPage}Page`).classList.remove('hidden');

        if (targetPage === 'youtube') {
          loadYouTubeVideos();
        }
      });
    });

    // Theme toggle
    document.getElementById('themeToggle').addEventListener('click', function() {
      this.classList.toggle('active');
      const sky = document.getElementById('starrySky');
      
      if (this.classList.contains('active')) {
        sky.classList.remove('night');
        sky.classList.add('day');
        currentTheme = 'day';
      } else {
        sky.classList.remove('day');
        sky.classList.add('night');
        currentTheme = 'night';
      }
    });

    // Language toggle
    document.getElementById('languageToggle').addEventListener('click', function() {
      this.classList.toggle('active');
      currentLanguage = this.classList.contains('active') ? 'en' : 'fr';
      updateLanguage();
    });

    function updateLanguage() {
      const t = translations[currentLanguage];
      
      document.querySelectorAll('.nav-link').forEach(link => {
        link.textContent = link.getAttribute(`data-${currentLanguage}`);
      });

      document.getElementById('homeTitle').textContent = `${t.welcomeTo} ${defaultConfig.site_name}`;
      document.getElementById('constructionMsg').textContent = t.construction;
      document.getElementById('aiIntro').innerHTML = `${t.aiIntro} <span class="font-bold" id="aiNameDisplay">${defaultConfig.ai_name}</span> ${t.accompanies}`;
      document.getElementById('youtubePageTitle').textContent = t.contentTitle;
      document.getElementById('loadingVideos').textContent = t.loadingVideos;
      document.getElementById('settingsTitle').textContent = t.settingsTitle;
      document.getElementById('themeLabel').textContent = t.themeLabel;
      document.getElementById('themeDesc').textContent = t.themeDesc;
      document.getElementById('languageLabel').textContent = t.languageLabel;
      document.getElementById('languageDesc').textContent = t.languageDesc;
      document.getElementById('aiMessage').textContent = t.aiMsg;
    }

    // Load YouTube videos
    async function loadYouTubeVideos() {
      const videoGrid = document.getElementById('videoGrid');
      const channelId = defaultConfig.youtube_channel_id;
      const apiKey = defaultConfig.youtube_api_key;

      if (!apiKey) {
        videoGrid.innerHTML = `
          <div class="col-span-full text-white text-center">
            <p class="text-xl mb-4">‚öôÔ∏è Configuration requise</p>
            <p class="text-white/70">Veuillez ajouter votre cl√© API YouTube dans les param√®tres √©ditables pour afficher les vid√©os.</p>
            <a href="https://www.youtube.com/@Krismeow" target="_blank" rel="noopener noreferrer" 
               class="inline-block mt-4 bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-8 rounded-full transition-all">
              Visiter la cha√Æne YouTube ‚Üí
            </a>
          </div>
        `;
        return;
      }

      try {
        const response = await fetch(
          `https://www.googleapis.com/youtube/v3/search?key=${apiKey}&channelId=${channelId}&part=snippet,id&order=date&maxResults=12&type=video`
        );
        
        const data = await response.json();

        if (data.items && data.items.length > 0) {
          videoGrid.innerHTML = data.items.map(item => {
            const videoId = item.id.videoId;
            const title = item.snippet.title;
            const thumbnail = item.snippet.thumbnails.high.url;

            return `
              <div class="video-card" onclick="window.open('https://www.youtube.com/watch?v=${videoId}', '_blank', 'noopener,noreferrer')">
                <img src="${thumbnail}" alt="${title}" class="video-thumbnail" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
                <div class="video-info">
                  <h3 class="text-white font-semibold line-clamp-2">${title}</h3>
                </div>
              </div>
            `;
          }).join('');
        } else {
          videoGrid.innerHTML = '<div class="col-span-full text-white text-center text-xl">Aucune vid√©o trouv√©e</div>';
        }
      } catch (error) {
        videoGrid.innerHTML = '<div class="col-span-full text-white text-center text-xl">Erreur lors du chargement des vid√©os</div>';
      }
    }

    // Initialize
    createStars();
    moveAIBubble();
    updateLanguage();

    // Elements SDK Integration
    async function onConfigChange(config) {
      const siteName = config.site_name || defaultConfig.site_name;
      const aiName = config.ai_name || defaultConfig.ai_name;

      document.getElementById('siteName').textContent = siteName;
      document.getElementById('aiChatName').textContent = aiName;
      
      defaultConfig.site_name = siteName;
      defaultConfig.ai_name = aiName;
      defaultConfig.youtube_api_key = config.youtube_api_key || defaultConfig.youtube_api_key;
      defaultConfig.youtube_channel_id = config.youtube_channel_id || defaultConfig.youtube_channel_id;
      
      updateLanguage();
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_color || defaultConfig.background_color,
              set: (value) => {
                config.background_color = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            },
            {
              get: () => config.ai_bubble_color || defaultConfig.ai_bubble_color,
              set: (value) => {
                config.ai_bubble_color = value;
                window.elementSdk.setConfig({ ai_bubble_color: value });
              }
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => {
                config.text_color = value;
                window.elementSdk.setConfig({ text_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (config) => new Map([
          ['site_name', config.site_name || defaultConfig.site_name],
          ['ai_name', config.ai_name || defaultConfig.ai_name],
          ['youtube_api_key', config.youtube_api_key || defaultConfig.youtube_api_key],
          ['youtube_channel_id', config.youtube_channel_id || defaultConfig.youtube_channel_id]
        ])
      });
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9b98ce41c7934ed3',t:'MTc2NzY3NzI0MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>